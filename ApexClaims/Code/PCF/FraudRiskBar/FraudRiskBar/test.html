<!DOCTYPE html>
<html>
<head>
    <title>FraudRiskBar PCF Control Test</title>
    <link rel="stylesheet" href="out/controls/RiskBar.css">
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            padding: 40px;
            background: #f5f5f5;
        }
        .test-container {
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            max-width: 600px;
            margin: 0 auto;
        }
        h1 {
            color: #333;
            margin-bottom: 30px;
        }
        .slider-container {
            margin-bottom: 30px;
            padding: 20px;
            background: #f9f9f9;
            border-radius: 4px;
        }
        input[type="range"] {
            width: 100%;
            margin: 10px 0;
        }
        .score-display {
            font-size: 24px;
            font-weight: bold;
            text-align: center;
            margin: 10px 0;
        }
        #control-container {
            min-height: 100px;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>FraudRiskBar PCF Control Test</h1>

        <div class="slider-container">
            <label>Adjust Risk Score:</label>
            <input type="range" id="scoreSlider" min="0" max="100" value="45">
            <div class="score-display">Score: <span id="scoreValue">45</span></div>
        </div>

        <div id="control-container"></div>
    </div>

    <script>
        window.ComponentFramework = {
            registerControl: function(name, ctor) {
                window._registeredControls = window._registeredControls || {};
                window._registeredControls[name] = ctor;
            }
        };
        window.ApexInsurance = window.ApexInsurance || {};
    </script>
    <script src="out/controls/bundle.js"></script>
    <script>
        function createMockContext(score) {
            return {
                parameters: {
                    riskScore: { raw: score },
                    showLabel: { raw: true },
                    showTicks: { raw: true },
                    showHeader: { raw: true },
                    enableAnimation: { raw: true },
                    enablePulse: { raw: true },
                    barHeight: { raw: 16 }
                },
                mode: {
                    isControlDisabled: false,
                    trackContainerResize: function() {}
                }
            };
        }

        window.onload = function() {
            var container = document.getElementById('control-container');
            var slider = document.getElementById('scoreSlider');
            var scoreValue = document.getElementById('scoreValue');

            var ControlClass = ApexInsurance.FraudRiskBar ||
                               (window._registeredControls && window._registeredControls['ApexInsurance.FraudRiskBar']);

            if (ControlClass) {
                var control = new ControlClass();
                var initialScore = parseInt(slider.value);

                control.init(createMockContext(initialScore), function() {}, {}, container);
                control.updateView(createMockContext(initialScore));

                slider.addEventListener('input', function() {
                    var score = parseInt(this.value);
                    scoreValue.textContent = score;
                    control.updateView(createMockContext(score));
                });
            }
        };
    </script>
</body>
</html>
